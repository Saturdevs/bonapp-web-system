<ng-template #cancelTemplate>
    <app-cancel-template [modalTitle]="modalCancelTitle" [modalMessage]="modalCancelMessage" (handleOkButton)="cancel()"
      (handleCancelButton)="closeModal()">
    </app-cancel-template>
  </ng-template>
  
  <ng-template #errorTemplate>
    <app-error-template [errorTitle]="modalErrorTittle" [errorMessage]="modalErrorMessage" (close)="closeModal()">
    </app-error-template>
  </ng-template>
  
  <ng-template #priceNotMatch>
    <app-cancel-template [modalTitle]="modalPriceNotMatchTitle" [modalMessage]="modalPriceNotMatchMessage"
      (handleOkButton)="closeModalAndContinue()" (handleCancelButton)="closeModal()">
    </app-cancel-template>
  </ng-template>
  
  <div class="pageTitle">
    <div class="float-left">
      <header>
        <h5>{{ pageTitle }}</h5>
      </header>
    </div>
  </div>
  <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 col-xl-12 pt-3 pb-3 pl-1 pr-1">
    <form method="post" novalidate [formGroup]="productForm">
      <div class="row mr-0 ml-0">
        <div class="col-md-6">
          <div class="row">
            <div class="col-md-7 col-lg-7">
              <div class="md-form">
                <input mdbActive formControlName="name" type="text" class="form-control"
                  [class.is-invalid]="productForm.get('name').invalid && (productForm.get('name').dirty || productForm.get('name').touched)"
                  id="name" length="25" mdbCharCounter>
                <label for="name" class="">Nombre</label>
              </div>
              <div
                *ngIf="productForm.get('name').invalid && (productForm.get('name').dirty || productForm.get('name').touched)"
                class="alert alert-danger">
                El nombre del Producto es requerido.
              </div>
            </div>
            <div class="col-md-5 col-lg-5">
              <div class="md-form">
                <input mdbActive formControlName="price" type="number" class="form-control"
                  [class.is-invalid]="productForm.get('price').invalid && (productForm.get('price').dirty || productForm.get('price').touched)"
                  id="price">
                <label for="name" class="">Precio ($):</label>
              </div>
              <div
                *ngIf="productForm.get('price').invalid && (productForm.get('price').dirty || productForm.get('price').touched)"
                class="alert alert-danger">
                El precio del Producto es requerido.
              </div>
            </div>
          </div>
  
          <div class="row">
            <div class="col-6">
              <div class="md-form">
                <textarea mdbActive formControlName="description" class="md-textarea" style="width: 100%;"
                  [class.is-invalid]="productForm.get('description').invalid && (productForm.get('description').dirty || productForm.get('description').touched)"
                  id="description"></textarea>
                <label for="description">Descripción</label>
              </div>
  
              <div
                *ngIf="productForm.get('description').invalid && (productForm.get('description').dirty || productForm.get('description').touched)"
                class="alert alert-danger">
                La descripción del producto es requerida.
              </div>
            </div>
            <div class="col-6">
              <app-file-input (validator)="onNotified($event)" [type]="'img'" [subtype]="'product'"></app-file-input>
              <div *ngIf="validPicture == false && pictureTouched == true" class="alert alert-danger">
                La imagen del producto es requerida.
              </div>
            </div>
          </div>
          <div class="row">
            <div class="ml-2 mr-2 pl-3 pr-3 pt-1 pb-2 mt-2 text-center">
              <div class="row mb-2 card pl-2 pr-2 pb-1 pt-1">
                <form #form="ngForm" novalidate class="form-inline">
                  <h6 class="pt-2">Filtrar:</h6>
                  <div class="md-form form-group mr-0 ml-0 col-md-2 col-lg-2">
                    <input type="text" class="input-alternate" placeholder="Nombre" name="query" [(ngModel)]='listFilter'
                      id="query">
                  </div>
                </form>
              </div>
  
              <div class="row">
                <table class="table table-bordered table-hover customTable" mdbTable #tableEl="mdbTable">
                  <thead class="primary-color customTableText">
                    <tr>
                      <th>Nombre</th>
                      <th>Agregar</th>
                    </tr>
                  </thead>
                  <tbody class="table-wrapper" *ngIf='productArray && productArray.length'>
                    <tr *ngFor='let product of filteredProductArray; let i = index'>
                      <td *ngIf='(i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex)'
                        class="align-middle customLongTh">{{ product.name }}</td>
                      <td *ngIf='(i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex)'
                        class="customThTd align-middle">
                        <mdb-checkbox formControlName="{{'available' + i}}" (change)="clickAvailable(product._id)"></mdb-checkbox>
                      </td>
                    </tr>
                  </tbody>
                  <tfoot class="grey lighten-5 w-100">
                    <tr>
                      <td colspan="2">
                        <mdb-table-pagination [tableEl]="tableEl" [searchDataSource]="filteredProductArray">
                        </mdb-table-pagination>
                      </td>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6 pr-0 pl-0">
          <img [src]="newProductPictureData" onerror="this.src='../../../assets/img/no-image.png'"
            style="width: 300px; height: 316px;" />
        </div>
      </div>
      <div class="row col-md-2 col-lg-2 col-xl-3 col-sm-2">
        <button class="btn btn-md btn-primary" type="button" (click)="showModalCancel(cancelTemplate)">Cancelar</button>
        <button class="btn btn-md btn-primary" [disabled]="productForm.invalid" type="submit"
          (click)="saveDailyMenu()">Guardar</button>
      </div>
    </form>
  </div>